--create the table format is database.schema.table
create or replace TABLE TEST.PUBLIC.TESTT (
	OWNER VARCHAR(16777216),
	LOGGROUP VARCHAR(16777216),
	LOGSTREAM VARCHAR(16777216),
	SUBSCRIPTION_FILTERS VARCHAR(16777216),
	TIMESTAMP TIMESTAMP,
	MESSAGE_TYPE VARCHAR(16777216),
	IDX VARCHAR(16777216),
	BILLED_DURATION NUMBER,
	MEMORY_SIZE NUMBER,
	MEMORY_USED NUMBER,
	INIT_DURATION NUMBER,
	MSTN VARCHAR(16777216),
	MESSAGE VARCHAR(16777216)
);

-- query to get interval
select
       time_slice(TIMESTAMP, 15, 'MINUTES', 'START') as "15 MINUTES INTERVAL",
       avg(BILLED_DURATION) "AVERAGE DURATION BILLED DURATION"
    from TESTT
    group by "15 MINUTES INTERVAL";

